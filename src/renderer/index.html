<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>MSA Server Manager</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div id="app">
    <div class="header">
        <div class="header-title">
            <svg class="icon" viewBox="0 0 24 24">
                <path d="M4 1h16a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1m0 11h16a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-7a1 1 0 0 1 1-1M6 5h1v1H6V5m0 11h1v1H6v-1z"/>
            </svg>
            <span>MSA Server Manager</span>
        </div>
        <button class="icon-button" id="settings-btn">
            <svg viewBox="0 0 24 24">
                <path d="M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10M10,22C9.75,22 9.54,21.82 9.5,21.58L9.13,18.93C8.5,18.68 7.96,18.34 7.44,17.94L4.95,18.95C4.73,19.03 4.46,18.95 4.34,18.73L2.34,15.27C2.21,15.05 2.27,14.78 2.46,14.63L4.57,12.97L4.5,12L4.57,11L2.46,9.37C2.27,9.22 2.21,8.95 2.34,8.73L4.34,5.27C4.46,5.05 4.73,4.96 4.95,5.05L7.44,6.05C7.96,5.66 8.5,5.32 9.13,5.07L9.5,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.5,2.42L14.87,5.07C15.5,5.32 16.04,5.66 16.56,6.05L19.05,5.05C19.27,4.96 19.54,5.05 19.66,5.27L21.66,8.73C21.79,8.95 21.73,9.22 21.54,9.37L19.43,11L19.5,12L19.43,13L21.54,14.63C21.73,14.78 21.79,15.05 21.66,15.27L19.66,18.73C19.54,18.95 19.27,19.04 19.05,18.95L16.56,17.95C16.04,18.34 15.5,18.68 14.87,18.93L14.5,21.58C14.46,21.82 14.25,22 14,22H10M11.25,4L10.88,6.61C9.68,6.86 8.62,7.5 7.85,8.39L5.44,7.35L4.69,8.65L6.8,10.2C6.4,11.37 6.4,12.64 6.8,13.8L4.68,15.36L5.43,16.66L7.86,15.62C8.63,16.5 9.68,17.14 10.87,17.38L11.24,20H12.76L13.13,17.39C14.32,17.14 15.37,16.5 16.14,15.62L18.57,16.66L19.32,15.36L17.2,13.81C17.6,12.64 17.6,11.37 17.2,10.2L19.31,8.65L18.56,7.35L16.15,8.39C15.38,7.5 14.32,6.86 13.12,6.62L12.75,4H11.25Z"/>
            </svg>
        </button>
    </div>

    <div class="quick-actions">
        <button class="action-button primary" id="start-all-btn">
            <svg viewBox="0 0 24 24">
                <path d="M8 5v14l11-7z"/>
            </svg>
            Start All
        </button>
        <button class="action-button secondary" id="stop-all-btn">
            <svg viewBox="0 0 24 24">
                <path d="M6 6h12v12H6z"/>
            </svg>
            Stop All
        </button>
        <button class="action-button danger" id="clear-all-btn">
            <svg viewBox="0 0 24 24">
                <path d="M19 4h-3.5l-1-1h-5l-1 1H5v2h14V4zM6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12z"/>
            </svg>
            Clear All
        </button>
    </div>

    <div class="server-list" id="server-list">
        <!-- Server items will be dynamically added here -->
    </div>

    <div class="status-bar">
        <span id="status-text">Loading servers...</span>
    </div>
</div>

<!-- Server Detail Modal -->
<div id="server-detail" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="detail-server-name">Server Name</h2>
            <button class="close-button" id="close-detail">√ó</button>
        </div>
        <div class="modal-body">
            <div class="detail-section">
                <div class="detail-header">
                    <h3>Configuration</h3>
                    <button class="edit-button" id="edit-server-btn" title="Edit Server">
                        <svg viewBox="0 0 24 24">
                            <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"/>
                        </svg>
                    </button>
                </div>
                
                <!-- Individual field editing view -->
                <div id="detail-view" class="info-grid">
                    <!-- Editable Name Field -->
                    <div class="info-row editable-field">
                        <span class="info-label">Name:</span>
                        <div class="editable-value" id="name-field">
                            <span id="detail-name" class="info-value"></span>
                            <button class="edit-field-btn" data-field="name" title="Edit Name">
                                <svg viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"/></svg>
                            </button>
                            <div class="edit-controls" style="display: none;">
                                <input type="text" class="field-input" id="edit-name-input" placeholder="Server name">
                                <button class="save-field-btn" data-field="name" title="Save">
                                    <svg viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg>
                                </button>
                                <button class="cancel-field-btn" data-field="name" title="Cancel">
                                    <svg viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/></svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Editable Path Field -->
                    <div class="info-row editable-field">
                        <span class="info-label">Path:</span>
                        <div class="editable-value" id="path-field">
                            <span id="detail-path" class="info-value"></span>
                            <button class="edit-field-btn" data-field="path" title="Edit Path">
                                <svg viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"/></svg>
                            </button>
                            <div class="edit-controls" style="display: none;">
                                <div class="input-group">
                                    <input type="text" class="field-input" id="edit-path-input" readonly placeholder="Select project folder...">
                                    <button class="browse-btn" data-field="path" title="Browse">üìÅ</button>
                                </div>
                                <button class="save-field-btn" data-field="path" title="Save">
                                    <svg viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg>
                                </button>
                                <button class="cancel-field-btn" data-field="path" title="Cancel">
                                    <svg viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/></svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Editable Command Field -->
                    <div class="info-row editable-field">
                        <span class="info-label">Command:</span>
                        <div class="editable-value" id="command-field">
                            <span id="detail-script" class="info-value"></span>
                            <button class="edit-field-btn" data-field="command" title="Edit Command">
                                <svg viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"/></svg>
                            </button>
                            <div class="edit-controls" style="display: none;">
                                <input type="text" class="field-input" id="edit-command-input" placeholder="e.g., npm start, node index.js">
                                <button class="save-field-btn" data-field="command" title="Save">
                                    <svg viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg>
                                </button>
                                <button class="cancel-field-btn" data-field="command" title="Cancel">
                                    <svg viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/></svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Editable Port Field -->
                    <div class="info-row editable-field">
                        <span class="info-label">Port:</span>
                        <div class="editable-value" id="port-field">
                            <span id="detail-port" class="info-value"></span>
                            <button class="edit-field-btn" data-field="port" title="Edit Port">
                                <svg viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"/></svg>
                            </button>
                            <div class="edit-controls" style="display: none;">
                                <input type="number" class="field-input" id="edit-port-input" placeholder="e.g., 3000" min="1000" max="65535">
                                <button class="save-field-btn" data-field="port" title="Save">
                                    <svg viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg>
                                </button>
                                <button class="cancel-field-btn" data-field="port" title="Cancel">
                                    <svg viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/></svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Read-only fields -->
                    <div class="info-row">
                        <span class="info-label">PID:</span>
                        <span id="detail-pid" class="info-value"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Uptime:</span>
                        <span id="detail-uptime" class="info-value"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">CPU:</span>
                        <span id="detail-cpu" class="info-value"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Memory:</span>
                        <span id="detail-memory" class="info-value"></span>
                    </div>
                </div>
                
                <!-- Edit form (hidden by default) -->
                <div id="detail-edit-form" class="edit-form hidden">
                    <div class="form-group">
                        <label for="edit-server-name">Server Name</label>
                        <input type="text" id="edit-server-name" placeholder="e.g., My API Server">
                    </div>
                    <div class="form-group">
                        <label for="edit-server-path">Project Path</label>
                        <div class="input-group">
                            <input type="text" id="edit-server-path" readonly placeholder="Select project folder...">
                            <button id="browse-edit-path-btn">Browse</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="edit-server-command">Run Command</label>
                        <input type="text" id="edit-server-command" placeholder="e.g., npm start, node index.js">
                    </div>
                    <div class="form-group">
                        <label for="edit-server-port">Port (Optional)</label>
                        <input type="number" id="edit-server-port" placeholder="e.g., 3000" min="1000" max="65535">
                    </div>
                    <div class="edit-actions">
                        <button class="action-button" id="cancel-edit-btn">Cancel</button>
                        <button class="action-button primary" id="save-edit-btn">Save Changes</button>
                    </div>
                </div>
            </div>

            <div class="detail-actions">
                <button class="action-button" id="open-browser-btn">
                    <svg viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                    </svg>
                    Open in Browser
                </button>
                <button class="action-button" id="open-terminal-btn">
                    <svg viewBox="0 0 24 24">
                        <path d="M20 19V7H4v12h16m0-16a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16m-7 14v-2h5v2h-5m-3.42-4L5.57 9l1.41-1.41L11.4 12l-4.42 4.42L5.57 13z"/>
                    </svg>
                    Open Terminal
                </button>
            </div>

            <div class="detail-section">
                <h3>Logs</h3>
                <div class="log-container" id="log-container">
                    <!-- Logs will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>
</div>

<script src="renderer.js"></script>

<!-- Settings Modal -->
<div id="settings-modal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Settings</h2>
            <button class="close-button" id="close-settings">√ó</button>
        </div>
        <div class="modal-body">
            <div class="settings-form">
                <div class="form-group preset-group">
                    <label for="preset-select">Configuration Preset</label>
                    <div class="input-group">
                        <select id="preset-select">
                            <option value="">Select a preset</option>
                        </select>
                        <button id="delete-preset-btn" class="small-icon-button" title="Delete selected preset">
                            <svg viewBox="0 0 24 24"><path d="M19 4h-3.5l-1-1h-5l-1 1H5v2h14V4zM6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12z"/></svg>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="root-path">Projects Root Folder</label>
                    <div class="input-group">
                        <input type="text" id="root-path" readonly placeholder="Select a folder...">
                        <button id="browse-btn">Browse</button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="run-command">Server Run Command</label>
                    <input type="text" id="run-command" placeholder="e.g., npm start">
                </div>
                
                <div class="settings-section">
                    <h3>Node.js Configuration</h3>
                    <div class="form-group">
                        <label for="node-path">Node.js Path</label>
                        <div class="input-group">
                            <input type="text" id="node-path" placeholder="Path to node executable">
                            <button id="browse-node-btn" class="small-icon-button" title="Browse for node executable">
                                <svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6m-1 1.5L18.5 9H13V3.5z"/></svg>
                            </button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="npm-path">NPM Path</label>
                        <div class="input-group">
                            <input type="text" id="npm-path" placeholder="Path to npm executable">
                            <button id="browse-npm-btn" class="small-icon-button" title="Browse for npm executable">
                                <svg viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6m-1 1.5L18.5 9H13V3.5z"/></svg>
                            </button>
                        </div>
                    </div>
                    <div class="form-group">
                        <button id="detect-paths-btn" class="action-button secondary">Auto-detect Paths</button>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="action-button" id="save-preset-btn">Save as Preset</button>
                <button class="action-button" id="cancel-settings-btn">Cancel</button>
                <button class="action-button primary" id="save-settings-btn">Apply</button>
            </div>
        </div>
    </div>
</div>

<!-- Add Server Modal -->
<div id="add-server-modal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Add Server</h2>
            <button class="close-button" id="close-add-server">√ó</button>
        </div>
        <div class="modal-body">
            <div class="settings-form">
                <div class="form-group">
                    <label for="server-name">Server Name</label>
                    <input type="text" id="server-name" placeholder="e.g., My API Server">
                </div>
                <div class="form-group">
                    <label for="server-path">Project Path</label>
                    <div class="input-group">
                        <input type="text" id="server-path" readonly placeholder="Select project folder...">
                        <button id="browse-server-path-btn">Browse</button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="server-command">Run Command</label>
                    <input type="text" id="server-command" placeholder="e.g., npm start, node index.js">
                </div>
                <div class="form-group">
                    <label for="server-port">Port (Optional)</label>
                    <input type="number" id="server-port" placeholder="e.g., 3000" min="1000" max="65535">
                </div>
            </div>
            <div class="modal-actions">
                <button class="action-button" id="cancel-add-server-btn">Cancel</button>
                <button class="action-button primary" id="save-add-server-btn">Add Server</button>
            </div>
        </div>
    </div>
</div>
</body>
</html>